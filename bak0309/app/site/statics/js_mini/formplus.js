var validatorMap={required:[LANG_formplus.validate["required"],function(c,a,d){if(d=="select-one"||d=="select"){var b=c.selectedIndex;a=c.options[b].value;return b>=0&&(a!=""&&a!="_NULL_")}return a!==null&&a.length!==0}],minLength:[function(b,a,c){if(typeOf(c)!="null"){return LANG_formplus.validate["minLength"].substitute({minLength:c,length:a.length})}return""},function(b,a,e,d,c){if(typeOf(c)!="null"){return a.length>=(c||0)}return true}],maxLength:[function(b,a,c){if(typeOf(c)!="null"){return LANG_formplus.validate["maxLength"].substitute({maxLength:c,length:a.length})}return""},function(b,a,e,d,c){if(typeOf(c)!="null"){return a.length<=(c||10000)}return true}],number:[LANG_formplus.validate["number"],function(b,a){return !isNaN(a)&&!/^\s+$/.test(a)}],msn:[LANG_formplus.validate["msn"],function(b,a){return a===null||a==""||/\S+@\S+/.test(a)}],skype:[LANG_formplus.validate["skype"],function(b,a){return !/\W/.test(a)||/^[a-zA-Z0-9]+$/.test(a)}],digits:[LANG_formplus.validate["digits"],function(b,a){return !/[^\d]/.test(a)}],unsignedint:[LANG_formplus.validate["unsignedint"],function(b,a){return(!/[^\d]/.test(a)&&a>0)}],unsigned:[LANG_formplus.validate["unsigned"],function(b,a){return(!isNaN(a)&&!/^\s+$/.test(a)&&a>=0)}],positive:[LANG_formplus.validate["positive"],function(b,a){return(!isNaN(a)&&!/^\s+$/.test(a)&&a>0)}],alpha:[LANG_formplus.validate["alpha"],function(b,a){return a===null||a==""||/^[a-zA-Z]+$/.test(a)}],alphaint:[LANG_formplus.validate["alphaint"],function(b,a){return !/\W/.test(a)||/^[a-zA-Z0-9]+$/.test(a)}],alphanum:[LANG_formplus.validate["alphanum"],function(b,a){return !/\W/.test(a)||/^[\u4e00-\u9fa5a-zA-Z0-9]+$/.test(a)}],unzhstr:[LANG_formplus.validate["unzhstr"],function(b,a){return !/\W/.test(a)||!/^[\u4e00-\u9fa5]+$/.test(a)}],date:[LANG_formplus.validate["date"],function(b,a){return a===null||a==""||/^(19|20)[0-9]{2}-([1-9]|0[1-9]|1[012])-([1-9]|0[1-9]|[12][0-9]|3[01])$/.test(a)}],email:[LANG_formplus.validate["email"],function(b,a){return a===null||a==""||/^[a-z\d][a-z\d_.]*@[\w-]+(?:\.[a-z]{2,})+$/i.test(a)}],emaillist:[LANG_formplus.validate["email"],function(b,a){return a===null||a==""||/^(?:[a-z\d][a-z\d_.]*@[\w-]+(?:\.[a-z]{2,})+[,;\s]?)+$/i.test(a)}],mobile:[LANG_formplus.validate["mobile"],function(b,a){return a===null||a==""||/^0?1[3458]\d{9}$/.test(a)}],tel:[LANG_formplus.validate["tel"],function(b,a){return a===null||a==""||/^(0\d{2,3}-?)?[23456789]\d{5,7}(-\d{1,5})?$/.test(a)}],phone:[LANG_formplus.validate["phone"],function(b,a){return a===null||a==""||/^0?1[3458]\d{9}$|^(0\d{2,3}-?)?[23456789]\d{5,7}(-\d{1,5})?$/.test(a)}],zip:[LANG_formplus.validate["zip"],function(b,a){return a===null||a==""||/^\d{6}$/.test(a)}],url:[LANG_formplus.validate["url"],function(b,a){var d="^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$";var c=new RegExp(d,"i");return a===null||a==""||c.test(a)}],area:[LANG_formplus.validate["area"],function(b,a){return b.getElements("select").every(function(d){var c=d.get("value");if(!d.isDisplayed()){return true}return c!=""&&c!="_NULL_"})}],equal:[LANG_formplus.validate["equal"],function(b,a,f,e,d){var c=e.getElement('[name="'+d+'"]');return !c||a===c.value}],onerequired:[LANG_formplus.validate["onerequired"],function(c,a,e,d){var b=c.name;return d.getElements("input"+(b?'[name="'+b+'"]':"")).some(function(f){if(["checkbox","radio"].contains(f.type)){return f.checked}return !!f.value})}]};var validate=function(a,d,c){a=(a||a===0)?document.id(a):null;d=d||"";if(!a){return true}var b=a.match("form")||d=="all"?a.getElements("[vtype], [pattern]"):Array.from(a);var e=[];b.each(function(j,h){if(!j.isVisible()){return true}var n=j.get("vtype").split("&&");var l=j.get("pattern");var k=new RegExp(l);var m=j.get("data-caution")||"";var g="custom_"+j.get("uid");if(l){if(!validatorMap[g]){validatorMap[g]=[j.get("data-attention")||"",function(o,i){return i===null||i===""||k.test(i)}]}n=n.clean().include(g)}if(j.get("required")){n=["required"].combine(n);j.erase("required")}if(!n.length){return true}var f=n.every(function(x,q){var t="";var r=x.split(":");x=r[0];if(r.length>1){var u=r[1]}var o=validatorMap[x];if(!o){return true}o=typeOf(o)==="array"?o:["",o];if(m){t=m.split("&&");t=t[q]||""}var s={el:j.getNext(".caution"),msg:t||(typeOf(o[0])==="function"?o[0](j,j.get("value"),u):o[0])};o=o[1]||function(){return true};var v=["input","select","textarea"].contains(j.get("tag"));if(o(j,j.get("value"),j.type,(a.match("[vtype]")||a.match("[pattern]"))?c||a.getParent("form")||a.getParent():a,u)){if(s.el){j.retrieve("tips_instance",{hide:function(){}}).hide(true)}v&&j.removeClass("caution-input");return true}else{s.el&&s.el.destroy();if(s.msg){var p=j.getParent(".l-error-tip")||j;formTips.error(s.msg,p).store()}if(j.bindEvent!==false){var w=v?"onblur":"onmouseout";j[w]=function(i){var y=i||window.event;if(!(/mouseout$/i.test(y.type)&&this.contains($(y.target||y.srcElement)))){validate(this,"",(a.match("[vtype]")||a.match("[pattern]"))?a.getParent("form")||a.getParent():a);s.el&&this.retrieve("tips_instance",{hide:function(){}}).hide(true);v&&this.removeClass("caution-input")}this[w]=null}}v&&j.addClass("caution-input");return false}});if(!f){e.push(j)}});if(e.length){e.shift().focus();return false}return true};var formTips=new Class({Implements:Options,options:{form:"inline",type:"error","class":"notice-inline",msg:"",target:document.body,destroy:false,position:["ct","cb"],offset:[0,-9],intoView:true,autohide:3},initialize:function(a){this.setOptions(a);this.hidden=true;return this},toElement:function(){if(!this.element){var b=this.options;this.uid=b.target.get("uid");this.uid++;var a=b.form=="inline"?"span":"div";var c="_build_tips_"+(b.form?b.form:"")+"_"+b.type+"_"+this.uid;this.element=b.single&&document.id(c)?document.id(c):new Element(a,{id:c,"class":"caution "+b.type+" "+b["class"],style:"display:none;",html:'<div class="caution-content"></div>'});this.element.inject(b.target,b.where)}return this.element},store:function(a){($(a)||this.options.target).store("tips_instance",this);return this},eliminate:function(a){($(a)||this.options.target).eliminate("tips_instance");return this},position:function(b){if(!this.element){document.id(this)}var a={target:b.target,from:tyeOf(b.position)=="array"?b.position[0]:"cb",to:tyeOf(b.position)=="array"?b.position[0]:b.position,offset:b.offset};return this.element.position(a)},show:function(c,a){if(typeOf(c)=="object"){a=c;c=a.msg}if(!this.hidden){return this}a=Object.merge(this.options,a||{});if(!this.element){document.id(this)}if(a.form&&a.form!="inline"){this.element.position(a)}if(a.intoView){try{new Fx.Scroll(document,{link:"cancel",duration:300}).toElementEdge(this.element)}catch(b){}}if(c){this.element.getElement(".caution-content").innerHTML=c}this.element.show();this.hidden=false;if(!isNaN(a.autohide)&&a.autohide>0){clearTimeout(this.timer);this.timer=this.hide.delay(a.autohide*1000,this)}return this.options.store?this.store(this.options.store):this},hide:function(a){a=a||this.options.destroy;if(this.hidden){return this}if(!this.element){document.id(this)}if(a!==false){this.element.destroy();this.element=null}else{this.element.hide()}this.hidden=true;return this.eliminate(this.options.store)}}).extend({tip:function(a,b){return new formTips({type:"notice",target:a||document.body,where:"after",autohide:0}).show(b)},error:function(c,b,a){return new formTips({type:"error",target:b||document.body,where:"after",autohide:0}).show(c,a)},success:function(c,b,a){return new formTips({type:"success",target:b||document.body,where:"after",autohide:0}).show(c,a)},warn:function(c,b,a){return new formTips({type:"warn",target:b||document.body,where:"top",autohide:0,"class":"caution-inline",single:true,store:true}).show(c,a)}});var passwordStrength=function(j,l,i){var h=/[a-z]/g;var k=/[A-Z]/g;var f=/\d/g;var c=/[\W_]/g;var b=new RegExp("(.{"+parseInt(j.length/2)+",})\1","g");var d=6;var a=20;var e=-1;var g="poor";if(!j||j.length<d){e=-1}else{e=parseInt(j.length/d)-1}if(j.match(b)){e--}if(j.match(h)||j.match(k)){e++}if(j.match(f)){e++}if(j.match(c)){e++}if(j.length>d&&e<2){e++}switch(e){case -1:case 0:case 1:g="poor";break;case 2:g="weak";break;case 3:g="good";break;default:g="strong";break}l.className=(i?i+" ":"")+"password-"+g}.extend({init:function(b,a){Array.from(b).each(function(d){if(!d){return}if(a){a=d.getParent().getElement(a)}else{a=d.getNext()}if(!a){return}var c=a.setStyle("visibility","visible").className;d.addEvent("inputchange",function(h){var f=passwordStrength.prev;var g=this.value;if(f!==g){passwordStrength(g,a,c)}passwordStrength.prev=g})})}});function changeVerify(b,a){Array.from(b).each(function(e){var d;var c;if(e.tagName==="IMG"){c=e;d=e.getAttribute("src").split("?")[0]}else{if(e.tagName==="A"){c=e.getPrevious("img");d=e.getAttribute("href")}}if(a){e.addEvent("click",changeCode.bind(e,c,d))}else{changeCode(c,d)}})}function changeCode(a,b){b=b||a.src.split("?")[0];var c=+new Date;a.src=b+"?"+c;return false}function checkAll(a,b){b.set("checked",a.checked)}var Placeholder={support:(function(){return"placeholder" in document.createElement("input")})(),className:"placeholder",init:function(){if(!Placeholder.support){Placeholder.create($$("input, textarea"))}},build:function(a,b){var c=a.getParent();if(c.getStyle("position")=="static"){c.setStyle("position","relative")}var d=a.getPrevious("."+this.className)||new Element("span."+this.className,{html:b,style:"visibility:hidden;"}).inject(a,"before").position({target:a,from:"lc",to:"lc",offset:{x:4},offsetParent:true}).addEvent("click",function(f){this.setStyle("visibility","hidden");a.focus()});return d},create:function(a){Array.from(a).each(function(b){if(!Placeholder.support&&b.get&&b.get("placeholder")){var c=b.get("placeholder");var d=Placeholder.build(b,c);if(b.value===""){d.setStyle("visibility","visible")}b.addEvents({focusin:function(f){d.setStyle("visibility","hidden")},focusout:function(f){if(this.value===""){d.setStyle("visibility","visible")}}})}})}};window.addEvent("domready",function(b){var a=document.forms;if(a.length){passwordStrength.init($$("form .auto-password-check-handle"));changeVerify($$("form .auto-change-verify-handle"),true);$$("form .action-remember-account").each(function(c){c.addEvent("change",function(d){if(this.checked){Memory.set("sign.remember","1",365)}else{Memory.set("sign.remember","0",365)}}).fireEvent("change")});$$("form .action-auto-signin").addEvent("change",function(c){if(this.checked){Memory.set("sign.auto","1",14)}else{Memory.clean("sign.auto")}})}Placeholder.init()});(function(){var b="disabled",a="rel";this.Sync=new Class({Extends:Request.HTML,options:{disabled:b,evalScripts:true,hideDelay:3,showMessage:true,position:"before",tipCls:"-tip",ajaxTip:"ajax-tip"},initialize:function(d,c){this.sponsor=d;if(d){c=this._getOptions(d,c)}this.parent(c)},_getOptions:function(j,f){f=f||{};var c;try{c=JSON.decode(j.get("data-ajax-config"))||{}}catch(i){c={}}var d,h,g=j.type==="submit";if(g){d=this.dataForm=j.getParent("form")}if(d){h={data:d.toQueryString()+"&response_json=true",url:d.action,method:d.method||"post"}}else{h={url:j.get("href"),data:"response_json=true",method:"get"}}c=Object.merge(h,f,j.retrieve("_ajax_config",{}),c);return c},_defaultState:function(){this.sponsor&&this.sponsor.removeClass(this.options.disabled)},onFailure:function(){this._defaultState();this.parent()},_getCache:function(c){return c.retrieve("ajax_cache",false)},_clearCache:function(c){c.eliminate("ajax_cache")},_setCache:function(c,d){c.store("ajax_cache",d)},_progressCache:function(c){var d=this._getCache(c);if(!this.options.syncCache||!d){return false}d.success(d.response.data);return true},success:function(d,c){this.response.data=d;if((/text\/jcmd/).test(this.getHeader("Content-type"))){return this._jsonSuccess(d)}if(["update","append","filter"].some(function(e){return this.options[e]},this)){return this.parent(d,c)}return this.onSuccess(this.processScripts(d),c)},_jsonSuccess:function(d){try{d=this.response.json=JSON.decode(d,this.options.secure)}catch(c){}this.onSuccess(d)},onSuccess:function(c){this._defaultState();if(this.options.syncCache&&this.sponsor){this._setCache(this.sponsor,this)}if(this.response.json){this._progress(c)}this.parent(arguments)},_progress:function(c){if(!c){return}if(this.options.progress){return this.options.progress.call(this,c)}var f=c.redirect;var d;if(!this.options.showMessage||["error","success"].every(function(g){d=c[g];if(!d){return true}if(this.options.inject){if(g===this.options.tipHidden){this._clearTip(g,d)}else{this._injectTip(g,d)}}else{Message(d,g,this.options.hideDelay,e)}return false},this)){e()}function e(){if(f){if(f=="back"){history.back()}else{if(f=="reload"){location.reload()}else{location.href=f}}}}},_clearTip:function(){if(!this.inject||!this.tipElem){return}this.tipElem.destroy()},_injectTip:function(e,h){var f=this.options,g=this.inject=document.id(f.inject),c=f.position,j=f.ajaxTip,d=f.tipCls,e=e+d,i;if(!g){return}i=g.getParent();this.tipElem=i.getElement("."+j);if(i&&this.tipElem){return this.tipElem.set("html",h)}new Element("div."+e+"."+j,{html:h}).inject(g,c)},_request:function(c){c.addClass(this.options.disabled)},_isCheck:function(d){d=d||{};var c=this.dataForm||d.data||this.options.data;if(typeOf(c)==="element"&&!validate(c)){return false}return true},send:function(c){var d=this.sponsor;if(d){if(d.hasClass(this.options.disabled)||!this._isCheck(c)||this._progressCache(d)){return}this._request(d)}this.parent(c)}});this.async=function(f,e,c){if(f.hasClass(b)){return false}if(typeOf(e)==="object"){c=e;e=null}else{if(typeOf(e)==="element"){if(!validate(e)){f.removeClass(b);return false}if(c&&c.async===false){return}}else{var d=f.retrieve("ajax_cache",false);if(d){return d.send()}}}new Sync(f,c).send()};this.Event_Group={_request:{fn:async}};$(document.html).addEvent("click",function(k){var j=$(k.target);if(!j||!j.nearest){return}var i=j.nearest("type","submit")||j.nearest(a);if(!i||i.nodeType===9||i.disabled){return}var h=i.getParent("form");if(h&&h.get("async")==="false"){return}if(i.type==="submit"&&h&&h.get("target")){return async(i,h,{async:false})}if(i.type==="submit"&&i.get(a)!=="_request"){return async(i,h)}var g=i.get(a),d=Event_Group[g];if(d){var f=d.fn,c=d.loader;k.preventDefault();if($(i).get&&$(i).get(g)){return i}if(c){$LAB.script(c).wait(function(){f&&f(i,h)})}else{f&&f(i,h)}}})})();