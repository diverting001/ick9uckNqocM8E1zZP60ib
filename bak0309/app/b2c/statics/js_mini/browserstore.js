(function(){var c={name:"localStorage",init:function(){if(!window.localStorage){return false}this._storage=window.localStorage;return this},setStorage:function(f,g){this._storage.setItem(f,g);return true},getStorage:function(f,j){var g=this._storage.getItem(f);var h=g?g:null;j(h)},removeStorage:function(f){this._storage.removeItem(f);return true},clearStorage:function(){if(this._storage.clear){this._storage.clear()}else{for(i in this._storage){if(this._storage[i].value){this.remove(i)}}}return true}};var d={name:"globalStorage",init:function(){if(!Browser.firefox||!window.globalStorage){return false}this._storage=globalStorage[location.hostname];return this},setStorage:function(f,g){this._storage.setItem(f,g);return true},getStorage:function(f,j){var g=this._storage.getItem(f);var h=g?g.value:null;j(h)},removeStorage:function(f){this._storage.removeItem(f);return true},clearStorage:function(){if(this._storage.clear){this._storage.clear()}else{for(i in this._storage){if(this._storage[i].value){this.remove(i)}}}return true}};var b={name:"userdata",init:function(){this.Master="ie6+";if(!Browser.ie){return false}this.file_name="ECStore_VS";if(!this._storage){try{var g=this._storage=document.createElement("input");g.type="hidden";g.addBehavior("#default#userData");document.body.appendChild(g);g.save(this.file_name)}catch(f){}}return this},setStorage:function(f,g){this._storage.setAttribute(f,g);this._storage.save(this.file_name);return true},getStorage:function(f,g){this._storage.load(this.file_name);g(this._storage.getAttribute(f))},removeStorage:function(f){this._storage.removeAttribute(f);this._storage.save(this.file_name);return true},clearStorage:function(){this._storage.load(this.file_name);var f=new Date();f.setMinutes(f.getMinutes()-1);this._storage.expires=f.toUTCString();this._storage.save(this.file_name);return true}};var a={name:"openDatabase",init:function(){if(!window.openDatabase){return false}this._storage=window.openDatabase("viewState","1.0","ECStore ViewState Storage",20000);this._createTable();return this},setStorage:function(f,g){this._storage.transaction(function(h){h.executeSql("SELECT v FROM SessionStorage WHERE k = ?",[f],function(k,j){if(j.rows.length){k.executeSql("UPDATE SessionStorage SET v = ?  WHERE k = ?",[g,f])}else{k.executeSql("INSERT INTO SessionStorage (k, v) VALUES (?, ?)",[f,g])}})});return true},getStorage:function(f,g){this._storage.transaction(function(h){v=h.executeSql("SELECT v FROM SessionStorage WHERE k = ?",[f],function(k,j){if(j.rows.length){return g(j.rows.item(0).v)}g(null)})})},removeStorage:function(f){this._storage.transaction(function(g){g.executeSql("DELETE FROM SessionStorage WHERE k = ?",[f])});return true},clearStorage:function(){this._storage.transaction(function(f){f.executeSql("DROP TABLE SessionStorage",[])});return true},_createTable:function(){this._storage.transaction(function(f){f.executeSql("SELECT COUNT(*) FROM SessionStorage",[],function(){},function(g,h){g.executeSql("CREATE TABLE SessionStorage (k TEXT, v TEXT)",[],function(){})})})}};var e={setStorage:function(){},getStorage:function(){},removeStorage:function(){},clearStorage:function(){}};BrowserStore=new Class({initialize:function(){this.storage=a.init()||d.init()||c.init()||b.init()||e;return this},set:function(f,g){g&&typeOf(g)==="string"&&this.storage.setStorage(f,g);return this},get:function(f,g){this.storage.getStorage(f,g)},remove:function(f){if(!f||!this.storage){return false}f&&this.storage.removeStorage(f);return this},clear:function(){if(!this.storage){return false}this.storage.clearStorage();return this}})})();