var priceControl={spec:{decimals:2,dec_point:".",thousands_sep:"",fonttend_decimal_type:0,fonttend_decimal_remain:2,sign:"\uffe5"},format:function(c,d){var b;var a=this.spec.sign||"";if(!(c||c===0)||isNaN(+c)){return c}var c=parseFloat(c);if(this.spec.cur_rate){c=c*this.spec.cur_rate}c=c.round(this.spec.decimals)+"";var f=c.indexOf(".");if(f<0){f=c.length;b=""}else{b=c.substr(f+1)}while(b.length<this.spec.decimals){b+="0"}var e=[];while(f>0){if(f>2){f-=3;e.unshift(c.substr(f,3))}else{e.unshift(c.substr(0,f));break}}if(!b){this.spec.dec_point=""}if(d){a='<span class="price-currency">'+a+"</span>"}return a+e.join(this.spec.thousands_sep)+this.spec.dec_point+b},number:function(a){if(!a){return null}if(isNaN(+a)){if(typeOf(a)==="element"){a=a.get(a.tagName==="INPUT"?"value":"text")}if(a.indexOf(this.spec.sign)==0){a=a.split(this.spec.sign)[1]}}return +a},calc:function(b,f,c,e){if(!(f||f===0)){return null}if(!c){f=this.number(f)}else{b=!b||b=="add"?1:-1;var g=1,d=1;if(typeOf(f)==="array"){g=f[1];f=f[0]}if(typeOf(c)==="array"){d=c[1];c=c[0]}var a=Math.pow(10,this.spec.decimals*this.spec.decimals);f=Math.abs(g*a*this.number(f)+b*d*a*this.number(c))/a}if(!e){f=this.format(f)}return f},add:function(c,b,a){return this.calc("add",c,b,a)},diff:function(c,b,a){return this.calc("diff",c,b,a)}};function bindDatepicker(a){if(!a){a="input.calendar"}a=$$(a);var c=window.Shop?Shop.url.datepicker:"";if(a.length){try{$LAB.script(c+"/datepicker.js").wait(function(){a.each(function(f){var d;try{d=JSON.decode(f.get("data-calendar-options"))}catch(g){}new DatePickers(f,d)})})}catch(b){}}}window.addEvent("domready",function(){bindDatepicker();var c=window.Shop?Shop.url.fav_url:"";var b=window.Shop?Shop.url.like_url:"";var g=Memory.get("member");var f=new Memory("gfav."+g,365);var a=function(k,j,m){if(!j){return}if(k.hasClass("fav-on")){return}var l=k.getParent(".p-action");if(m){return h(l)}var i=k.get("_type")?k.get("_type"):"goods";new Request({url:c,onRequest:function(){this.FAVHTML=l.innerHTML;l.innerHTML='<span class="fav-loading">收藏中...</span>'},onSuccess:function(n){n=JSON.decode(n);if(n&&n.success){l.innerHTML='<span class="fav-success"><q class="icon">&#x25;</q> 收藏成功</span>';h.delay(2000,this,l)}else{l.innerHTML=this.FAVHTML}}}).post({type:i,gid:j});function h(n){return;n.innerHTML='<span class="fav-on c-green">已收藏</span> <a href="javascript:void(0);" class="btn-delete c-org">删除</a>'}};var e=function(k,j,l){if(!j){return}if(l){return h()}var i=k.get("data-type")?k.get("data-type"):"goods";new Request({url:c,onRequest:function(){this.FAVHTML=k.innerHTML;k.innerHTML='<span class="fav-loading">收藏中...</span>'},onSuccess:function(m){m=JSON.decode(m);if(m.success){h()}}}).post({type:i,gid:j});function h(){var m=k.getParent().getElement("[rev="+k.get("rel")+"]");m.setStyle("display","").replaces(k)}};var d=Array.from((f.read()||"").split(","));$$("a[rel=_addfav_]").each(function(i){var h=i.get("data-gid");if(d.contains(h)){a(i,h,true)}});$$("[rel=_favbtn_]").each(function(i){var h=i.get("data-gid");if(d.contains(h)){e(i,h,true)}});if(window.Event_Group){Object.merge(Event_Group,{_addfav_:{fn:function(i){var h=$(i.target)||$(i);a(h,h.get("data-gid"));return false}},_logins_:{fn:function(i){var h=$(i.target)||$(i);miniPassport(h.get("data-url"))}},_setlike_:{fn:function(l){var j=$(l.target)||$(l);var i=j.get("data-gid");var h=b||j.get("data-url");var k=j.hasClass("liked");var _msg = '收藏成功';if(k){h=h+"?act=del";_msg="已移除收藏";}new Request.JSON({url:h,onRequest:function(){},onSuccess:function(n){if(n.success||n.success==0){var o=j.get("data-type");o&&j.getParent("li").remove();Message.success(_msg);j[k?"removeClass":"addClass"]("liked");if(n.success>0){var m=n.success}else{var m="&nbsp;"}j.set("html",m);updateLike()}else{Message.error("操作失败")}}}).post({gid:i});return false}},_addlike_:{fn:function(l){var j=$(l.target)||$(l);var i=j.get("data-gid");var h=b||j.href;var k=j.hasClass("liked");if(k){h=h+"?act=del"}new Request.JSON({url:h,onRequest:function(){},onSuccess:function(n){if(n.success||n.success==0){if(n.success>0){var m=n.success}else{var m="&nbsp;"}j[k?"removeClass":"addClass"]("liked");j.set("html","<s></s>"+m);updateLike()}}}).post({gid:i});return false}},_favbtn_:{fn:function(i){var h=$(i.target)||$(i);e(h,h.get("data-gid"));return false}}})}});function starGrade(a,d,c){a=$(a);d=parseInt(d);if(!a){return}var b=a.getElements(c||".scores-item");b.each(function(g){var i=g.getElement(".stars");var e=g.getElements("[class*=star-]");var f=g.getElement("input[type=hidden]");var h=g.getElement(".score");if(d||d===0){i.className="stars stars-"+d;h.set("text",d);f.value=d;return}i.addEvent("mouseleave",function(){var j=f.value;this.className="stars stars-"+j;h.set("text",j)});e.each(function(k,j){k.addEvents({mouseenter:function(){this.getParent(".stars").className="stars stars-"+(j+1);h.set("text",j+1)},click:function(){f.value=j+1}})})})};