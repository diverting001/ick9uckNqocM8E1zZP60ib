<form method="post" id="tag_form_add" action="<{$action}>">
<div class="tableform" id="imageset">
    <div class="division">
        <table width="100%" cellspacing="0" cellpadding="0">
        <tbody>
			<tr>
				<th><{t app='tags'}>标识名<{/t}></th>
				<td>
				  <{input type="text" value=$data.tag_name name="tag_name" autocomplete="off"}>
				</td>
			</tr>
			<tr>
				<th><{t app='tags'}>标识图片<{/t}></th>
				<td>
					<{input type="image" value=$data.params.tag_image name="params[tag_image]"}>
					<em>图片高为20，宽度不限</em>
				</td>
			</tr>
			<{input type="hidden" value=$data.tag_id name="tag_id"}>
			<{input type="hidden" value=$data.app_id name="app_id"}>
			<{input type="hidden" value=$data.tag_type name="tag_type"}>
        </tbody>
        </table>
        </div>
        <div class="table-action">
        <{button label=$___image="确定"|t:'tags' class="btn-primary" type="submit"}>
    </div>
</div>
</form>
<script>

$ES('.pos-select','imageset').each(function(table){
    var ipt=$E('input',table);
    table.addEvent('click',function(e){
        var target=new Event(e).target;
        if(target.tagName=='TD' && target.get('v')){
            try{$E('td.current',table).removeClass('current')}catch(e){}
            ipt.value=target.get('v');
            target.addClass('current');
        }
    });
    if(ipt.value){
        try{$E('td[v="'+ipt.value+'"]',table).addClass('current');}catch(e){}
    }
});

$('tag_form_add').store('target',{
    onComplete:function(){

        if(finderGroup['<{$env.get.finder_id}>'])
        finderGroup['<{$env.get.finder_id}>'].refresh();

        $('tag_form_add').getParent('.dialog').retrieve('instance').close();
    }

});
</script>
